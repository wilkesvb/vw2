function array_unique_noempty(e){var t=[];jQuery.each(e,function(e,n){n=jQuery.trim(n);n&&jQuery.inArray(n,t)==-1&&t.push(n)});return t}var tagBox,commentsBox,editPermalink,makeSlugeditClickable,WPSetThumbnailHTML,WPSetThumbnailID,WPRemoveThumbnail,wptitlehint;(function(e){tagBox={clean:function(e){var t=postL10n.comma;","!==t&&(e=e.replace(new RegExp(t,"g"),","));e=e.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,"");","!==t&&(e=e.replace(/,/g,t));return e},parseTags:function(t){var n=t.id,r=n.split("-check-num-")[1],i=e(t).closest(".tagsdiv"),s=i.find(".the-tags"),o=postL10n.comma,u=s.val().split(o),a=[];delete u[r];e.each(u,function(t,n){n=e.trim(n);n&&a.push(n)});s.val(this.clean(a.join(o)));this.quickClicks(i);return!1},quickClicks:function(t){var n=e(".the-tags",t),r=e(".tagchecklist",t),i=e(t).attr("id"),s,o;if(!n.length)return;o=n.prop("disabled");s=n.val().split(postL10n.comma);r.empty();e.each(s,function(t,n){var s,u;n=e.trim(n);if(!n)return;s=e("<span />").text(n);if(!o){u=e('<a id="'+i+"-check-num-"+t+'" class="ntdelbutton">X</a>');u.click(function(){tagBox.parseTags(this)});s.prepend("&nbsp;").prepend(u)}r.append(s)})},flushTags:function(t,n,r){n=n||!1;var i=e(".the-tags",t),s=e("input.newtag",t),o=postL10n.comma,u,a;a=n?e(n).text():s.val();tagsval=i.val();u=tagsval?tagsval+o+a:a;u=this.clean(u);u=array_unique_noempty(u.split(o)).join(o);i.val(u);this.quickClicks(t);n||s.val("");"undefined"==typeof r&&s.focus();return!1},get:function(t){var n=t.substr(t.indexOf("-")+1);e.post(ajaxurl,{action:"get-tagcloud",tax:n},function(r,i){if(0==r||"success"!=i)r=wpAjax.broken;r=e('<p id="tagcloud-'+n+'" class="the-tagcloud">'+r+"</p>");e("a",r).click(function(){tagBox.flushTags(e(this).closest(".inside").children(".tagsdiv"),this);return!1});e("#"+t).after(r)})},init:function(){var t=this,n=e("div.ajaxtag");e(".tagsdiv").each(function(){tagBox.quickClicks(this)});e("input.tagadd",n).click(function(){t.flushTags(e(this).closest(".tagsdiv"))});e("div.taghint",n).click(function(){e(this).css("visibility","hidden").parent().siblings(".newtag").focus()});e("input.newtag",n).blur(function(){this.value==""&&e(this).parent().siblings(".taghint").css("visibility","")}).focus(function(){e(this).parent().siblings(".taghint").css("visibility","hidden")}).keyup(function(t){if(13==t.which){tagBox.flushTags(e(this).closest(".tagsdiv"));return!1}}).keypress(function(e){if(13==e.which){e.preventDefault();return!1}}).each(function(){var t=e(this).closest("div.tagsdiv").attr("id");e(this).suggest(ajaxurl+"?action=ajax-tag-search&tax="+t,{delay:500,minchars:2,multiple:!0,multipleSep:postL10n.comma+" "})});e("#post").submit(function(){e("div.tagsdiv").each(function(){tagBox.flushTags(this,!1,1)})});e("a.tagcloud-link").click(function(){tagBox.get(e(this).attr("id"));e(this).unbind().click(function(){e(this).siblings(".the-tagcloud").toggle();return!1});return!1})}};commentsBox={st:0,get:function(t,n){var r=this.st,i;n||(n=20);this.st+=n;this.total=t;e("#commentsdiv .spinner").show();i={action:"get-comments",mode:"single",_ajax_nonce:e("#add_comment_nonce").val(),p:e("#post_ID").val(),start:r,number:n};e.post(ajaxurl,i,function(t){t=wpAjax.parseAjaxResponse(t);e("#commentsdiv .widefat").show();e("#commentsdiv .spinner").hide();if("object"==typeof t&&t.responses[0]){e("#the-comment-list").append(t.responses[0].data);theList=theExtraList=null;e("a[className*=':']").unbind();commentsBox.st>commentsBox.total?e("#show-comments").hide():e("#show-comments").show().children("a").html(postL10n.showcomm);return}if(1==t){e("#show-comments").html(postL10n.endcomm);return}e("#the-comment-list").append('<tr><td colspan="2">'+wpAjax.broken+"</td></tr>")});return!1}};WPSetThumbnailHTML=function(t){e(".inside","#postimagediv").html(t)};WPSetThumbnailID=function(t){var n=e('input[value="_thumbnail_id"]',"#list-table");n.size()>0&&e("#meta\\["+n.attr("id").match(/[0-9]+/)+"\\]\\[value\\]").text(t)};WPRemoveThumbnail=function(t){e.post(ajaxurl,{action:"set-post-thumbnail",post_id:e("#post_ID").val(),thumbnail_id:-1,_ajax_nonce:t,cookie:encodeURIComponent(document.cookie)},function(e){e=="0"?alert(setPostThumbnailL10n.error):WPSetThumbnailHTML(e)})}})(jQuery);jQuery(document).ready(function(e){var t,n,r="",i=0,s=e("#content");postboxes.add_postbox_toggles(pagenow);e("#tagsdiv-post_tag").length?tagBox.init():e("#side-sortables, #normal-sortables, #advanced-sortables").children("div.postbox").each(function(){if(this.id.indexOf("tagsdiv-")===0){tagBox.init();return!1}});e(".categorydiv").each(function(){var t=e(this).attr("id"),n=!1,r,i,s,o,u;s=t.split("-");s.shift();o=s.join("-");u=o+"_tab";o=="category"&&(u="cats");e("a","#"+o+"-tabs").click(function(){var t=e(this).attr("href");e(this).parent().addClass("tabs").siblings("li").removeClass("tabs");e("#"+o+"-tabs").siblings(".tabs-panel").hide();e(t).show();"#"+o+"-all"==t?deleteUserSetting(u):setUserSetting(u,"pop");return!1});getUserSetting(u)&&e('a[href="#'+o+'-pop"]',"#"+o+"-tabs").click();e("#new"+o).one("focus",function(){e(this).val("").removeClass("form-input-tip")});e("#new"+o).keypress(function(t){if(13===t.keyCode){t.preventDefault();e("#"+o+"-add-submit").click()}});e("#"+o+"-add-submit").click(function(){e("#new"+o).focus()});r=function(){if(n)return;n=!0;var t=jQuery(this),r=t.is(":checked"),i=t.val().toString();e("#in-"+o+"-"+i+", #in-"+o+"-category-"+i).prop("checked",r);n=!1};catAddBefore=function(t){if(!e("#new"+o).val())return!1;t.data+="&"+e(":checked","#"+o+"checklist").serialize();e("#"+o+"-add-submit").prop("disabled",!0);return t};i=function(t,n){var r,i=e("#new"+o+"_parent");e("#"+o+"-add-submit").prop("disabled",!1);if("undefined"!=n.parsed.responses[0]&&(r=n.parsed.responses[0].supplemental.newcat_parent)){i.before(r);i.remove()}};e("#"+o+"checklist").wpList({alt:"",response:o+"-ajax-response",addBefore:catAddBefore,addAfter:i});e("#"+o+"-add-toggle").click(function(){e("#"+o+"-adder").toggleClass("wp-hidden-children");e('a[href="#'+o+'-all"]',"#"+o+"-tabs").click();e("#new"+o).focus();return!1});e("#"+o+'checklist li.popular-category input[type="checkbox"], #'+o+'checklist-pop input[type="checkbox"]').live("click",function(){var t=e(this),n=t.is(":checked"),r=t.val();r&&t.parents("#taxonomy-"+o).length&&e("#in-"+o+"-"+r+", #in-popular-"+o+"-"+r).prop("checked",n)})});e("#postcustom").length&&e("#the-list").wpList({addAfter:function(t,n){e("table#list-table").show()},addBefore:function(t){t.data+="&post_id="+e("#post_ID").val();return t}});if(e("#submitdiv").length){t=e("#timestamp").html();n=e("#post-visibility-display").html();function o(){var t=e("#post-visibility-select");if(e("input:radio:checked",t).val()!="public"){e("#sticky").prop("checked",!1);e("#sticky-span").hide()}else e("#sticky-span").show();e("input:radio:checked",t).val()!="password"?e("#password-span").hide():e("#password-span").show()}function u(){if(!e("#timestampdiv").length)return!0;var n,r,i,s,o=e("#post_status"),u=e('option[value="publish"]',o),a=e("#aa").val(),f=e("#mm").val(),l=e("#jj").val(),c=e("#hh").val(),h=e("#mn").val();n=new Date(a,f-1,l,c,h);r=new Date(e("#hidden_aa").val(),e("#hidden_mm").val()-1,e("#hidden_jj").val(),e("#hidden_hh").val(),e("#hidden_mn").val());i=new Date(e("#cur_aa").val(),e("#cur_mm").val()-1,e("#cur_jj").val(),e("#cur_hh").val(),e("#cur_mn").val());if(n.getFullYear()!=a||1+n.getMonth()!=f||n.getDate()!=l||n.getMinutes()!=h){e(".timestamp-wrap","#timestampdiv").addClass("form-invalid");return!1}e(".timestamp-wrap","#timestampdiv").removeClass("form-invalid");if(n>i&&e("#original_post_status").val()!="future"){s=postL10n.publishOnFuture;e("#publish").val(postL10n.schedule)}else if(n<=i&&e("#original_post_status").val()!="publish"){s=postL10n.publishOn;e("#publish").val(postL10n.publish)}else{s=postL10n.publishOnPast;e("#publish").val(postL10n.update)}r.toUTCString()==n.toUTCString()?e("#timestamp").html(t):e("#timestamp").html(s+" <b>"+e('option[value="'+e("#mm").val()+'"]',"#mm").text()+" "+l+", "+a+" @ "+c+":"+h+"</b> ");if(e("input:radio:checked","#post-visibility-select").val()=="private"){e("#publish").val(postL10n.update);u.length==0?o.append('<option value="publish">'+postL10n.privatelyPublished+"</option>"):u.html(postL10n.privatelyPublished);e('option[value="publish"]',o).prop("selected",!0);e(".edit-post-status","#misc-publishing-actions").hide()}else{if(e("#original_post_status").val()=="future"||e("#original_post_status").val()=="draft"){if(u.length){u.remove();o.val(e("#hidden_post_status").val())}}else u.html(postL10n.published);o.is(":hidden")&&e(".edit-post-status","#misc-publishing-actions").show()}e("#post-status-display").html(e("option:selected",o).text());if(e("option:selected",o).val()=="private"||e("option:selected",o).val()=="publish")e("#save-post").hide();else{e("#save-post").show();e("option:selected",o).val()=="pending"?e("#save-post").show().val(postL10n.savePending):e("#save-post").show().val(postL10n.saveDraft)}return!0}e(".edit-visibility","#visibility").click(function(){if(e("#post-visibility-select").is(":hidden")){o();e("#post-visibility-select").slideDown("fast");e(this).hide()}return!1});e(".cancel-post-visibility","#post-visibility-select").click(function(){e("#post-visibility-select").slideUp("fast");e("#visibility-radio-"+e("#hidden-post-visibility").val()).prop("checked",!0);e("#post_password").val(e("#hidden_post_password").val());e("#sticky").prop("checked",e("#hidden-post-sticky").prop("checked"));e("#post-visibility-display").html(n);e(".edit-visibility","#visibility").show();u();return!1});e(".save-post-visibility","#post-visibility-select").click(function(){var t=e("#post-visibility-select");t.slideUp("fast");e(".edit-visibility","#visibility").show();u();e("input:radio:checked",t).val()!="public"&&e("#sticky").prop("checked",!1);1==e("#sticky").prop("checked")?r="Sticky":r="";e("#post-visibility-display").html(postL10n[e("input:radio:checked",t).val()+r]);return!1});e("input:radio","#post-visibility-select").change(function(){o()});e("#timestampdiv").siblings("a.edit-timestamp").click(function(){if(e("#timestampdiv").is(":hidden")){e("#timestampdiv").slideDown("fast");e("#mm").focus();e(this).hide()}return!1});e(".cancel-timestamp","#timestampdiv").click(function(){e("#timestampdiv").slideUp("fast");e("#mm").val(e("#hidden_mm").val());e("#jj").val(e("#hidden_jj").val());e("#aa").val(e("#hidden_aa").val());e("#hh").val(e("#hidden_hh").val());e("#mn").val(e("#hidden_mn").val());e("#timestampdiv").siblings("a.edit-timestamp").show();u();return!1});e(".save-timestamp","#timestampdiv").click(function(){if(u()){e("#timestampdiv").slideUp("fast");e("#timestampdiv").siblings("a.edit-timestamp").show()}return!1});e("#post").on("submit",function(t){if(!u()){t.preventDefault();e("#timestampdiv").show();e("#publishing-action .spinner").hide();e("#publish").prop("disabled",!1).removeClass("button-primary-disabled");return!1}});e("#post-status-select").siblings("a.edit-post-status").click(function(){if(e("#post-status-select").is(":hidden")){e("#post-status-select").slideDown("fast");e(this).hide()}return!1});e(".save-post-status","#post-status-select").click(function(){e("#post-status-select").slideUp("fast");e("#post-status-select").siblings("a.edit-post-status").show();u();return!1});e(".cancel-post-status","#post-status-select").click(function(){e("#post-status-select").slideUp("fast");e("#post_status").val(e("#hidden_post_status").val());e("#post-status-select").siblings("a.edit-post-status").show();u();return!1})}if(e("#edit-slug-box").length){editPermalink=function(t){var n,r=0,i=e("#editable-post-name"),s=i.html(),o=e("#post_name"),u=o.val(),a=e("#edit-slug-buttons"),f=a.html(),l=e("#editable-post-name-full").html();e("#view-post-btn").hide();a.html('<a href="#" class="save button button-small">'+postL10n.ok+'</a> <a class="cancel" href="#">'+postL10n.cancel+"</a>");a.children(".save").click(function(){var n=i.children("input").val();if(n==e("#editable-post-name-full").text())return e(".cancel","#edit-slug-buttons").click();e.post(ajaxurl,{action:"sample-permalink",post_id:t,new_slug:n,new_title:e("#title").val(),samplepermalinknonce:e("#samplepermalinknonce").val()},function(t){e("#edit-slug-box").html(t);a.html(f);o.val(n);makeSlugeditClickable();e("#view-post-btn").show()});return!1});e(".cancel","#edit-slug-buttons").click(function(){e("#view-post-btn").show();i.html(s);a.html(f);o.val(u);return!1});for(n=0;n<l.length;++n)"%"==l.charAt(n)&&r++;slug_value=r>l.length/4?"":l;i.html('<input type="text" id="new-post-slug" value="'+slug_value+'" />').children("input").keypress(function(e){var t=e.keyCode||0;if(13==t){a.children(".save").click();return!1}if(27==t){a.children(".cancel").click();return!1}o.val(this.value)}).focus()};makeSlugeditClickable=function(){e("#editable-post-name").click(function(){e("#edit-slug-buttons").children(".edit-slug").click()})};makeSlugeditClickable()}if(typeof wpWordCount!="undefined"){e(document).triggerHandler("wpcountwords",[s.val()]);s.keyup(function(t){var n=t.keyCode||t.charCode;if(n==i)return!0;(13==n||8==i||46==i)&&e(document).triggerHandler("wpcountwords",[s.val()]);i=n;return!0})}wptitlehint=function(t){t=t||"title";var n=e("#"+t),r=e("#"+t+"-prompt-text");n.val()==""&&r.removeClass("screen-reader-text");r.click(function(){e(this).addClass("screen-reader-text");n.focus()});n.blur(function(){this.value==""&&r.removeClass("screen-reader-text")}).focus(function(){r.addClass("screen-reader-text")}).keydown(function(t){r.addClass("screen-reader-text");e(this).unbind(t)})};wptitlehint();(function(){function i(e){t.height(Math.max(50,n+e.pageY)+"px");return!1}function s(n){var r;t.focus();e(document).unbind("mousemove",i).unbind("mouseup",s);r=parseInt(t.css("height"),10);r&&r>50&&r<5e3&&setUserSetting("ed_size",r)}var t=e("textarea#content"),n=null,r;if(!t.length||"ontouchstart"in window)return;t.css("resize","none");r=e('<div id="content-resize-handle"><br></div>');e("#wp-content-wrap").append(r);r.on("mousedown",function(r){n=t.height()-r.pageY;t.blur();e(document).mousemove(i).mouseup(s);return!1})})();typeof tinymce!="undefined"&&tinymce.onAddEditor.add(function(t,n){function r(){var t,n=document.getElementById("content_ifr"),r=n?parseInt(n.style.height,10):0,i=e("#content_tbl tr.mceFirst").height();if(!r||!i)return!1;t=r+i+21;t-=33;return t}if(n.id!="content"||tinymce.isIOS5)return;n.onLoadContent.add(function(t,n){var r,i=document.getElementById("content"),s=i?parseInt(i.style.height,10):0,o=e("#content_tbl tr.mceFirst").height()||33;if(!s||s<50||s>5e3)s=360;getUserSetting("ed_size")>5e3&&setUserSetting("ed_size",360);r=s-o+12;if(r>50&&r<5e3){e("#content_tbl").css("height","");e("#content_ifr").css("height",r+"px")}});n.onSaveContent.add(function(t,n){var i=r();if(!i||i<50||i>5e3)return;e("textarea#content").css("height",i+"px")});n.onPostRender.add(function(){e("#content_resize").on("mousedown.wp-mce-resize",function(t){e(document).on("mouseup.wp-mce-resize",function(t){var n;e(document).off("mouseup.wp-mce-resize");n=r();n&&n>50&&n<5e3&&setUserSetting("ed_size",n)})})})})});